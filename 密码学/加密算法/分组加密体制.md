# 分组加密体制

[TOC]

## 1 Feis tel 密码结构

### 1.1 Feis tel 加密结构

加密算法的输入是分组长为 $2w$ 的明文 $M$ 和一个密钥 $K=\{K_1,K_2,\ldots,K_n \}$ 。将明文分组分成左右两半 $L$ 和 $R$ ，然后进行n轮迭代，迭代完成后，再将左右两半合并到一起以产生密文分组。其第i轮迭代的函数为：

> $L_i=R_{i-1}$
>
> $R_i=L_{i-1}\bigoplus F(R_{i-1},K_i)$
>
> 其中 $K_i$ 是第 $i$ 轮用的子密钥，由加密密钥 $K$ 得到。一般，各轮子密钥彼此不同且与 $K$ 也不同。

 Feistel 网络中每轮结构都相同，每轮中右半数据被作用于轮函数 $F$ 后，再与左半数据进行异或运算，这一过程为 <font color = "red">代换</font> 。每轮轮函数的结构都相同，但以不同的密钥 $K_i$ 作为参数。代换过程完成后，再交换左右两半数据，这一过程称为 <font color = "red">置换</font> 。

Feistel 网络的实现与以下参数和特性有关：

> （1）分组大小。分组越大则越安全，但是加密速度就越慢。分组密码设计中最为普遍使用的分组大小是 64 bite。
>
> （2）密钥大小。密钥越长则越安全，但是加密速度就越慢。现在普遍认为 64 bite 或更短的密钥是不安全的，通常使用 128 bite 长的密钥。
>
> （3）轮数。单论结构远不能保证安全性，多轮结构可以提供足够的安全性。典型的，轮数取为 16 。
>
> （4）子密钥产生算法。该算法复杂性越高，则密码分析的困难下就越大。
>
> （5）轮函数。轮函数的复杂性越高，则密码分析的困难下就越大。

在设计 Feistel 网络时，还要考虑一下两个问题：

> （1）快速的软件实现。在很多情况下，算法是被嵌在应用程序中的，因而无法使用硬件实现。此算法的执行速度是考虑的关键。
>
> （2）算法容易分析。算法能被无疑义地解释清楚，就可以容易地分析算法抵抗攻击地能力，有助于设计高强度地算法。

### 1.2 Feis tel 解密结构

Feistel 解密过程本质上和加密过程是一样地，算法使用密文作为输入，但使用子密钥 $K_i$ 的次序与加密过程相反。这一特性保证了解密和加密可采用同一种算法。



## 2 DES 

### 2.1 DES 描述

DES算法为密码体制中的对称密码体制，又被称为美国数据加密标准。DES是一个分组加密算法，典型的DES以64位为分组对数据加密，加密和解密用的是同一个算法。

DES加密算法：明文分组长为64bit，密钥长为56bit，加密过程有三个阶段，首先是一个初始置换 $IP$ ，用于重排明文分组的64bit数据。然后是具有相同功能的16轮变换，每轮中都有置换和代换运算，第16轮变换算的输出分为左右两半，并被交换次序。最后在经过一个逆初始 ${IP}^{-1}$ ，从而产生64bit的密文。除初始置换和逆置换外，DES的结构与Feistel密码结构完全相同。



